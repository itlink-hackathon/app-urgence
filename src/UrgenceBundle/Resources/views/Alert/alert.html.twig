{% extends 'UrgenceBundle::layout.html.twig' %}

{% block title %}Alerter les secours{% endblock %}

{% block content %}
<form role="form" class="form-horizontal">
    <div class="form-group">
        <label class="control-label col-xs-3" for="lastname">Nom</label>
        <div class="col-xs-9">
            <input id="lastname" type="text" class="form-control" placeholder="Entrez votre nom...">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="firstname">Prénom</label>
        <div class="col-xs-9">
            <input id="firstname" type="text" class="form-control" placeholder="Entrez votre prénom...">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="phonenumber">Téléphone</label>
        <div class="col-xs-9">
            <input id="phonenumber" type="text" class="form-control" placeholder="Entrez votre téléphone...">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="email">E-mail</label>
        <div class="col-xs-9">
            <input id="email" type="text" class="form-control" placeholder="Entrez votre e-mail...">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="type-alerte">Type d'alerte</label>
        <div class="col-xs-9">
            <select id="type-alerte" class="form-control">
                <option>Sélectionnez un type d'alerte...</option>
                <option>Accident</option>
                <option>Agression</option>
                <option>Attentat</option>
                <option>Catastrophe naturelle</option>
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="gravite">Type d'alerte</label>
        <div class="col-xs-9">
            <select id="gravite" class="form-control">
                <option>Indiquez la gravité de la situation...</option>
                <option>Mineure</option>
                <option>Moyenne</option>
                <option>Urgent</option>
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="infos">Informations complémentaires</label>
        <div class="col-xs-9">
            <textarea id="infos" class="form-control" placeholder="Ajouter des informations complémentaires"
                      rows="3"></textarea>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-3" for="position">Ma position</label>
        <div class="col-xs-9">
            <div class="container-fluid rounded-border padding-10">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="checkbox" style="display: inline-block;">
                            <label>
                                <input type="checkbox"> Position GPS
                            </label>
                        </div>
                        <button class="btn btn-default"><i class="fa fa-map-marker"></i> Obtenir</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

<button id="button-post" class="btn btn-default">Click Send Post test (TO REMOVE) </button>
<script type="text/javascript">
    $( document ).ready(function() {
        $('#button-post').click(function(){
            var data = {};
            data['timestamp_alert'] = new Date().getTime();
            data['timestamp_position'] = new Date().getTime()+99999; 
            data['position'] = {'longitude' : "0000", 'latitude' : "0000" };
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position){
                    data['position'] = {'longitude' : position.coords.longitude, 'latitude' : position.coords.latitude };
                });
            }
            
            $.ajax({
                  type: "POST",
                  url: "/hackathon-2016/app_dev.php/api/new-alerte",
                  data: JSON.stringify(data),
                  success: function(response){
                      console.log(response);
                  },
                  dataType: 'json',
                  error:function(msg){
                      alert( "Error !: " + msg );
                  }
            });
        });

        
    });
</script>
{% endblock %}